{% comment %}
#
# Copyright Â© 2012 Red Hat, Inc.
#
# This software is licensed to you under the GNU General Public
# License as published by the Free Software Foundation; either version
# 2 of the License (GPLv2) or (at your option) any later version.
# There is NO WARRANTY for this software, express or implied,
# including the implied warranties of MERCHANTABILITY,
# NON-INFRINGEMENT, or FITNESS FOR A PARTICULAR PURPOSE. You should
# have received a copy of GPLv2 along with this software; if not, see
# http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.
{% endcomment %}
<html>
    <head>
        <link href="https://access.redhat.com/chrome_themes/umbra/s/global.css?version=1.6.5.2" media="screen, print" type="text/css" rel="stylesheet"/>
        <link href="https://access.redhat.com/chrome_themes/umbra/s/print.css?version=1.6.5.2" media="print" type="text/css" rel="stylesheet"/>
        <link href="https://access.redhat.com/webassets/avalon/s/jquery-ui/cp/jquery-ui-1.8.7.custom.css?version=1.6.5.2" media="screen, print" type="text/css" rel="stylesheet"/>
        <link href="{{ STATIC_URL }}jquery.jqplot.min.css" type="text/css" rel="stylesheet"/>
        <link href="{{ STATIC_URL }}chosen.css" type="text/css" rel="stylesheet"/>
        <link href="{{ STATIC_URL }}report.css" type="text/css" rel="stylesheet"/>
        <link href="{{ STATIC_URL }}TableTools.css" type="text/css" rel="stylesheet"/>
        <script src="{{ STATIC_URL }}jquery.min.js"></script>
        <script src="{{ STATIC_URL }}jquery-ui.min.js"></script>
        <script src="{{ STATIC_URL }}jquery-csrf.js"></script>
        <script src="{{ STATIC_URL }}jquery.jqplot.min.js"></script>
        <script src="{{ STATIC_URL }}jqplot.canvasTextRenderer.min.js"></script>
        <script src="{{ STATIC_URL }}jqplot.canvasAxisLabelRenderer.min.js"></script>
        <script src="{{ STATIC_URL }}chosen.jquery.js"></script>
        <script src="http://datatables.net/download/build/jquery.dataTables.min.js"></script> 
        <script src="{{ STATIC_URL }}TableTools.min.js"></script>
        <script src="{{ STATIC_URL }}index.js"></script>
        <script src="{{ STATIC_URL }}copy_csv_xls_pdf.swf"></script>
        <script>

        function populateDetailReport(rtn) {
            //var pane = $('#details > table');

            // cleanup
            $('#details').empty();
            $('#instance_details').empty();
            var header = $('<h2>Unique Resources</h2>');
            var detail_table = $('<table style="width: 100%; margin-bottom: 0;"></table>');
            $('#details').append(header);
            $('#details').append(detail_table);

            var reportDetailTableData = [];

            detail_table = detail_table.dataTable({
                    "bAutoWidth": true,
                    "bJQueryUI": true,
                    "aoColumns": [
                    {"sTitle": "Count"},
                    {"sTitle": "UUID"},
                    {"sTitle": "Number of Checkins"}
                    ],
                    "sDom": 'T<"clear">lfrtip',
                    "oTableTools": {
                    "sSwfPath": "{{ STATIC_URL }}copy_csv_xls_pdf.swf",
                    "aButtons": [
                    {
                    "sExtends": "copy",
                    "sButtonText": "Copy to clipboard"
                    },
                    {
                    "sExtends": "csv",
                    "sButtonText": "Save to CSV"
                    },
                    {
                        "sExtends": "pdf",
                        "sButtonText": "Save to PDF"
                    }
            ]
                    }
            });

            for (var instance_index=0; instance_index < rtn.list.length; instance_index++) {
                var instance = rtn.list[instance_index];

                var i = instance_index + 1;

                detail_table.fnAddData([i, instance.instance, instance.count]);
            }

            // attach event
            detail_table.children('tbody').find('tr').each(function() {
                    $(this).click(function() {
                        $(this).siblings().each(function() {
                            $(this).removeClass('highlighted');
                            });
                        $(this).addClass('highlighted');
                        var instance = $($(this).children('td')[1]).text();
                        createInstanceDetail(rtn.start, rtn.end, instance, escape(new String(rtn.this_filter)));
                        });
                    });


        }

        function populateInstanceDetailReport(rtn) {
            // cleanup
            $('#instance_details').empty();
            var header = $('<h2>Number of Checkins</h2>');
            var table = $('<table style="width: 100%; margin-bottom: 0;"></table>');
            $('#instance_details').append(header);
            $('#instance_details').append(table);

            var pane = $('#instance_details > table');

            var instanceDetailTableData = [];

            instance_table = pane.dataTable({
                    "bAutoWidth": false,
                    "bJQueryUI": true,
                    "aoColumns": [
                    {"sTitle": "Count"},
                    {"sTitle": "UUID"},
                    {"sTitle": "Product"},
                    {"sTitle": "Time"},
                    {"sTitle": "Products"},
                    {"sTitle": "Memory"},
                    {"sTitle": "CPU Sockets"},
                    {"sTitle": "Reporting Domain"},
                    ],
                    "sDom": 'T<"clear">lfrtip',
                    "oTableTools": {
                    "sSwfPath": "{{ STATIC_URL }}copy_csv_xls_pdf.swf",
                    "aButtons": [
                    {
                    "sExtends": "copy",
                    "sButtonText": "Copy to clipboard"
                    },
                    {
                        "sExtends": "csv",
                        "sButtonText": "Save to CSV"
                    },
                    {
                        "sExtends": "pdf",
                        "sButtonText": "Save to PDF"
                    }
            ]
                    }
            });

            for (var instance_index=0; instance_index <  rtn.list.length; instance_index++) {
                var instance = rtn.list[instance_index];

                var i = instance_index + 1;

                //instanceDetailTableData.push([i, instance.instance_identifier, instance.product_name, instance.hour, instance.product, instance.memtotal, instance.cpu_sockets, instance.environment]);
                instance_table.fnAddData([i, instance.instance_identifier, instance.product_name, instance.hour, instance.product, instance.memtotal, instance.cpu_sockets, instance.environment]);

            }

            // if currently hidden, turn it on
            if (!$('#instance_details').is(':visible')) {
                $('#instance_details').show();
            }
        }
        </script>
        <style>
            #outer-wrapper {
                background: #E6E6E6;
            }
            #navPrimary {
                clear: both;
            }

            input {
                vertical-align: bottom;
            }
            #form_error {
                color: red;
            }
			li.disabled {
				opacity: 0.35;
			}
            div.datatables_sort_wrapper {
                position: relative;
                padding-right: 14px;
                text-align: center;
            }
            div.datatables_sort_wrapper span {
                margin-top: -8px;
                position: absolute;
                right: 0;
                top: 50%;
            }
            table.dataTable td {
                text-align: center;
            }
            tr.highlighted {
                background-color: #A1ACB2 !important;
                color: #FFFFFF;
            }
            .dataTables_wrapper {
                min-height: 0px !important; 
            }
        </style>
    </head>
    <body>
	    <div id="outer-wrapper" class="wrapo">
	        <div id="wrapper" class="wrapo">
            	<div id="header-wrap" class="wrapi">
                	<div id="header">

                    	<div id="brand">
                    		<a id="rhLogo" href="http://www.redhat.com/" title="Go to redhat.com">
                	    		<img src="https://access.redhat.com/chrome_themes/umbra/g/logo_redhat.png" alt="Red Hat logo">
                    		</a>
                    	</div>

                        <div id="utility">
                        	<div id="utility-links">
        		                <div id="account-links" class="account-links" style="display:block">
                        			<span style="color: #FFFFFF;">
                                  		<div style="padding: 4 2;">
                			                <!-- Login Button -->
                                			<button id="login-button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class='ui-button-text'>Login</span></button>
                                			<!-- Logout Button -->
                                 			<button id="logout-button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class='ui-button-text'>Logout</span></button>
                                        </div>

                                        <p>
                            		    {% if user.is_authenticated %}
                                            {{ user.username }} account #{{ user.account }}
                                            <script type='text/javascript'>
                                                first_logged_in = true;
                                            </script>
                                            {% if user.is_staff and user.is_superuser %}
                                                <script type='text/javascript'>
                                                    is_admin = true;
                                                    turnOnAdminFeatures();
                                                </script>
                                            {% endif %}
		                                {% else %}
                        		            You are not logged in.
                                            <script type='text/javascript'>
                                                first_logged_in = false;
                                            </script>
		                                {% endif %}
                                        </p>
                	            	</span>
                       			</div>
                        	</div>
                        </div>
                        <div id='navWrap' class='clearWrap'>
                            <div id='navPrimary'>
                                <ul>
                                    <!--
                                        Create a much more generic way of attaching and
                                        exercising onclick events.
                                    -->
                                    <li id='create_button' class='active'><a href="#">Create Report</a></li>
                                    <li id='report_button'><a href='#'>View Report</a></li>
                                    <li id='detail_button'><a href='#'>View Detail</a></li>
                                    <li id='max_button'   ><a href="#">Max Data</a></li>
                                    <li id='import_button'><a href="#">Import Data</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div id='main-wrap' class='wrapu'>
                    <div id='main-top'></div>
                    <div class='wrapi'>
                        <div id='container' class='clearWrap'>
                            <div id='create_pane'>
                                <fieldset>
                                    <form id="report_form">
                                     <h2>Filter by Date:</h2>
                                        <table>
                                            <tr>
                                                <td width="10%">
                                                    <div style='display: inline-block'>
                                                        
                                                        <b style='padding-top: 1em'> Month:</b>
                                                        <select name=byMonth id="byMonth" class='chosen' style="width:100px;" disabled="false">
                                                            <option value="-1">Select Month</option>
                                                            <option value="1">January</option>
                                                            <option value="2">February</option>
                                                            <option value="3">March</option>
                                                            <option value="4">April</option>
                                                            <option value="5">May</option>
                                                            <option value="6">June</option>
                                                            <option value="7">July</option>
                                                            <option value="8">August</option>
                                                            <option value="9">September</option>
                                                            <option value="10">October</option>
                                                            <option value="11">November</option>
                                                            <option value="12">December</option>
                                                        </select> 
                                                    </div>
                                                </td>
                                            </tr>
        
                                            <tr>
                                                <td width="50%"> 
                                                    <div style='display: inline-block'>
                                                        
                                                        <b>Custom Range:</b> 
                                                            Start Date: <input type="text" id="startDate" name="startDate">
                                                            End Date: <input type="text" id="endDate" name="endDate"> </p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
        
                                        <h2>Filter by Customer Data:</h2> 
                                        <table>
                                            <tr>
                                                <td width="5%"> 
                                                    
                                                    <b> Contract: </b> </td> 
                                                    <td width="40%">
                                                        <select id="contract" name=contract_number class='chosen'  style="width:150px;" disabled="false"> 
                                                            
                                                        </select> 
                                                    </td>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%"> 
                                                    
                                                    <b> RHIC: </b></td>
                                                    <td width="40%">
                                                        <select id="rhic" name="rhic" class='chosen' style="width:400px;" disabled="false">
                                                        </select>
                                                    </td>
                                                </td>
                                            </tr>
                                        </table>
                                        <h2>Filter by Reporting Domain:</h2> 
                                        <table>
                                            <tr> 
                                                <td width="1%"><b>Reporting Domain: </b></td>
                                                    <td width="51%">
                                                        <select id='env' name="env" class='chosen'  style="width:150px;" disabled="false">
                                                            
                                                        </select>
                                                    </td>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%">
                                                    <button id='submit' name='submit' class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" onclick='createReport(event)'>
                                                        <span class='ui-button-text'>Run Report</span>
                                                    </button>
                                                </td>
                                                <td width="5%">
                                                    <button id='clear' class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" onclick='resetReportForm()'>
                                                        <div id='original'>
                                                            <span class='ui-button-text original' style='float:left'>Reset Form</span>
                                                        </div>
                                                        <div id='choices'>
                                                            <span class='ui-button-text' style='float:left'>Yes</span>
                                                            <span class='ui-button-text' style='float:left'>No</span>
                                                        </div>
                                                    </button>
                                                </td>
                                            </tr>
                                        </table>
                                        <div id='form_error'>
                                        </div>
                                    </form>
                                </fieldset>
                            </div>
                            <div id='report_pane'>
                                <div>
                                    <h3>This date range contains no usage data.</h3>
                                    <br></br>
                                    <br></br>
                                </div>
                                    <button id='createAnotherReport_button' class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" onclick='openCreate()'>
                                        <span class='ui-button-text'>Run another report</span>
                                    </button>
                                <table width="100%">
                                    <tbody>
                                        <tr>
                                            <td><h3>Glossary:</h3></td>
                                        </tr>
                                        <tr>
                                        <td width="15%">SLA :</td>
                                        <td>Service level agreement as defined in the customers contract</td>
                                        </tr>
                                        <tr>
                                        <td width="15%">Support :</td>
                                        <td>Support parameters as defined in the customers contract</td>
                                        </tr>
                                        <tr>
                                        <tr>
                                        <td width="15%">Facts :</td>
                                        <td>Characteristics of both hardware and software of the resource</td>
                                        </tr>
                                        <tr>
                                            <td width="15%">Contracted Use:</h3></td>
                                            <td>This is the number of concurrent entitlements purchased in the contract</td>
                                        </tr>
                                        <tr>
                                            <td width="15%">NAU:</td>
                                            <td>Net Aggregate Usage, is the number of concurrent entitlements actually being consumed</td>
                                        </tr>
                                        <tr>
                                            <td width="15%">Consumed :</td>
                                            <td>Defined as an entitlement being installed and running on an instance or physical machine. If an instance is not running ( ie.. shutdown or terminated), then it is not counted as consumed</td>
                                        </tr>
                                        
                                    </tbody>
                                </table>
                            </div>
                            <div id='detail_pane'>
                                <div id='details'>
                                    <h2>Unique Resources:</h2>
                                    <table style="width: 100%; margin-bottom: 0;">
                                    </table>
                                </div>
                                <br></br>
                                <div id='instance_details'>
                                    
                                </div>
                            </div>
                            <div id='max_pane'>
                                <br></br>
                                <div id='max_details'>
                              
                                </div>
                            </div>
                            <div id='import_pane'>
                                <div>
                                </div>
                                <br></br>
                                <h2> Demonstration Purposes Only.   Import will not be available to non admin users in a G.A. or production deployment</h2>
                                <button id='createAnotherReport_button' class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" onclick='importData()'>
                                    <span class='ui-button-text'>Import Data</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Login Form -->
        <div id="login-form" title="Login">
            <form>{% csrf_token %}
                <fieldset>
                    <label for="username">Username</label><br>
                    <input type="text" name="username" id="username" class="text ui-widget-content ui-corner-all" /><br>
                    <label for="password">Password</label><br>
                    <input type="password" name="password" id="password" class="text ui-widget-content ui-corner-all" />
                </fieldset>
            </form>
            <div id="login-error" class="ui-state-error">
                <div class="ui-state-error-text">
                    <p>Invalid Username or Password.</p>
                    <p>Please try again.</p>
                </div>
            </div>
            <div id="relogin" class="ui-helper-hidden">
                <p>Your session has expired, you must relogin.</p>
            </div>
        </div>
    </body>
</html>
